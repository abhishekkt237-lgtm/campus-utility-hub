<!DOCTYPE html>
<html>
<head>
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

  <title>User Dashboard</title>
  <style>
    * {
      font-family: roboto, arial;
    }
    body {
      font-family: Roboto, Arial;
      background-image: linear-gradient(135deg, rgba(225, 223, 226, 0.7), rgb(230, 222, 235,0.7), rgba(207, 204, 210, 0.7));
      padding: 30px;
    }
    .card {
      max-width: 600px;
      margin: 11.5px  auto;
      background: rgb(195, 181, 205);
      border-radius: 8px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
     .head {
      text-align: center;
      font-weight: 500;
      font-size: 30px;
      background-color:rgb(123, 90, 148);
      padding: 8px 0;
      border-radius: 6px 6px 0 0 ;
        box-shadow: 0 5px 15px rgba(0,0,0,0.15);
        color: white;
     }
     .img {
      text-align: center;
      padding: 20px 0 0 0;
      
     }
     .profileimg {
      height: 120px;
      width: 120px;
       box-shadow: 0 0 10px 5px rgba(0,0,0,0.2);
     }
     .info {
      padding:0 20px 10px 10px;
      font-size: 17.5px;
     }
     p {
      margin: 15px;
     }
     .btn {
      text-align: center;
     }
     button {
      width: 120px;
      margin: 25px 3px 0 3px;
      background-color: rgb(125, 88, 153);
      border: none;
      border-radius: 4px;
      font-size: 18px;
      cursor: pointer;
      padding: 10px 15px;
      transition: all 0.15s;
       box-shadow: 0 0 10px 5px rgba(0,0,0,0.2);
    
     }
     button:hover {
      background-color: rgb(60, 38, 78) ;
      color: aliceblue;
     }

  </style>
</head>

<body>

<div class="card">
  <div class="head">
 Your Profile
  </div>
  <div class="img">

<img class="profileimg" id="profilePic" width="120" style="border-radius:50%"><br><br>
  </div>
  <div class="info">

<p><b>Name:</b> <span id="name"></span></p>
<p><b>Admission No:</b> <span id="admission"></span></p>
<p><b>Branch:</b> <span id="branch"></span></p>
<p><b>DOB:</b> <span id="dob"></span></p>
<p><b>Phone:</b> <span id="phone"></span></p>
<p><b>Hostel:</b> <span id="hostel"></span></p>
<p><b>Block:</b> <span id="block"></span></p>
<p><b>Room:</b> <span id="room"></span></p>
<p><b>Mess:</b> <span id="mess"></span></p>
  </div>
</div>
 <div class="btn">
<button id="edit">Edit Profile</button>
<button id="logout">Logout</button>
<button onclick="window.location.href='front.html'" id="logout">Go Back</button>
 </div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } 
from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";
import { getFirestore, doc, getDoc } 
from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAVGVP0c6e9KMdp2RmqOeGGVxr8kFsXZ7M",
  authDomain: "campus-utility-hub-iitism.firebaseapp.com",
  projectId: "campus-utility-hub-iitism",
  storageBucket: "campus-utility-hub-iitism.firebasestorage.app",
  messagingSenderId: "281851939722",
  appId: "1:281851939722:web:62f0da477d4c2a917f5673"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// DOM references
const nameEl = document.getElementById("name");
const admissionEl = document.getElementById("admission");
const branchEl = document.getElementById("branch");
const dobEl = document.getElementById("dob");
const phoneEl = document.getElementById("phone");
const hostelEl = document.getElementById("hostel");
const blockEl = document.getElementById("block");
const roomEl = document.getElementById("room");
const messEl = document.getElementById("mess");
const profilePic = document.getElementById("profilePic");

const editBtn = document.getElementById("edit");
const logoutBtn = document.getElementById("logout");

onAuthStateChanged(auth, async (user) => {
  if (!user) {
    window.location.href = "../login.html";
    return;
  }

  const snap = await getDoc(doc(db, "users", user.uid));
  if (snap.exists()) {
    const d = snap.data();

    nameEl.textContent = d.fullName;
    admissionEl.textContent = d.admission;
    branchEl.textContent = d.branch;
    dobEl.textContent = d.dob;
    phoneEl.textContent = d.phone;
    hostelEl.textContent = d.hostel;
    blockEl.textContent = d.block;
    roomEl.textContent = d.room;
    messEl.textContent = d.mess;

    profilePic.src = d.photoURL || "default.png";
  }
});

// buttons
editBtn.addEventListener("click", () => {
  window.location.href = "edit-profile.html";
});

logoutBtn.addEventListener("click", async () => {
  await signOut(auth);
  window.location.href = "../login.html";
});
</script>


</body>
</html>

